<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Color Wordle</title>
<style>
    body {
        font-family: Arial, sans-serif;
        background: #0f0f0f;
        color: white;
        display: flex;
        flex-direction: column;
        align-items: center;
        margin-top: 40px;
    }
    input {
        padding: 10px;
        font-size: 18px;
        width: 200px;
        border-radius: 6px;
        border: none;
        margin-bottom: 10px;
    }
    button {
        padding: 10px 20px;
        font-size: 18px;
        border: none;
        border-radius: 6px;
        background: #ff8800;
        color: black;
        cursor: pointer;
        font-weight: bold;
    }
    .guess-box {
        margin-top: 20px;
        width: 300px;
        height: 80px;
        border-radius: 10px;
        border: 2px solid #444;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 20px;
        margin-bottom: 15px;
    }
</style>
</head>
<body>

<h1>Color Wordle</h1>
<p>Enter a color (hex or name). Try to match the secret color!</p>

<div id="guessBox" class="guess-box">Your guess will show here</div>

<input id="colorInput" placeholder="#3498db or red">
<button onclick="makeGuess()">Guess</button>

<p id="resultMsg"></p>

<script>
    // Generate random color
    function randomColor() {
        return "#" + Math.floor(Math.random() * 16777215).toString(16).padStart(6, '0');
    }

    let secret = randomColor();
    console.log("Secret color:", secret); // for debugging

    // Convert any CSS color to RGB object
    function toRGB(color) {
        let ctx = document.createElement("canvas").getContext("2d");
        ctx.fillStyle = color;
        return ctx.fillStyle; // browser converts it to a full color string
    }

    function rgbObj(color) {
        color = toRGB(color);
        let m = color.match(/rgba?\((\d+), (\d+), (\d+)/);
        return { r: +m[1], g: +m[2], b: +m[3] };
    }

    // Calculate similarity (0â€“100%) using RGB distance
    function colorSimilarity(c1, c2) {
        let rDiff = c1.r - c2.r;
        let gDiff = c1.g - c2.g;
        let bDiff = c1.b - c2.b;

        let distance = Math.sqrt(rDiff * rDiff + gDiff * gDiff + bDiff * bDiff);
        let maxDistance = Math.sqrt(255*255*3); // max RGB distance

        return Math.round((1 - (distance / maxDistance)) * 100);
    }

    function makeGuess() {
        let guess = document.getElementById("colorInput").value.trim();
        if (!guess) return;

        let guessBox = document.getElementById("guessBox");

        // Try applying the color to check if valid
        try {
            guessBox.style.background = guess;
        } catch {
            alert("Invalid color!");
            return;
        }

        let guessRGB = rgbObj(guess);
        let secretRGB = rgbObj(secret);

        let similarity = colorSimilarity(guessRGB, secretRGB);

        if (similarity === 100) {
            guessBox.style.background = secret;
            document.getElementById("resultMsg").innerHTML =
                `ðŸŽ‰ Correct! The secret color was <b>${secret}</b>. Reload to play again.`;
        } else {
            document.getElementById("resultMsg").innerHTML =
                `You're ${similarity}% close!`;
        }
    }
</script>

</body>
</html>
