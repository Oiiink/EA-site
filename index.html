<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Color Wordle+</title>

<style>
    body {
        font-family: Arial, sans-serif;
        background: #0f0f0f;
        color: white;
        display: flex;
        flex-direction: column;
        align-items: center;
        margin-top: 40px;
    }

    h1 {
        font-size: 40px;
        margin-bottom: 10px;
        color: #ffa500;
    }

    input {
        padding: 10px;
        font-size: 18px;
        width: 240px;
        border-radius: 6px;
        border: none;
        margin-bottom: 10px;
        outline: none;
    }

    button {
        padding: 10px 20px;
        font-size: 18px;
        border: none;
        border-radius: 6px;
        background: #ffa500;
        color: black;
        cursor: pointer;
        font-weight: bold;
    }

    #guessList {
        margin-top: 25px;
        width: 350px;
    }

    .guessItem {
        display: flex;
        justify-content: space-between;
        align-items: center;
        background: #1c1c1c;
        padding: 10px;
        border-radius: 8px;
        margin-bottom: 8px;
        border: 1px solid #333;
    }

    .swatch {
        width: 40px;
        height: 40px;
        border-radius: 6px;
        border: 2px solid #555;
    }

    .correct {
        border-color: #0f0;
        box-shadow: 0 0 10px #0f0;
    }
</style>
</head>
<body>

<h1>Color Wordle</h1>
<p>Type any color (hex or name). Try to match the secret color!</p>

<input id="colorInput" placeholder="Example: light pink, #3498db">
<button onclick="makeGuess()">Guess</button>

<div id="guessList"></div>

<p id="resultMsg" style="font-size: 22px; margin-top: 20px;"></p>

<script>

// ðŸŽ¨ Pick random secret color
function randomColor() {
    return "#" + Math.floor(Math.random() * 16777215)
        .toString(16).padStart(6, '0');
}

let secret = randomColor();
console.log("Secret color:", secret); // debug

// ðŸŽ¨ Convert any color string â†’ full rgb() format
function normalizedColor(color) {
    let ctx = document.createElement("canvas").getContext("2d");
    ctx.fillStyle = color;
    return ctx.fillStyle; // browser auto-converts
}

// ðŸŽ¨ Convert rgb(...) â†’ {r,g,b}
function rgbObj(color) {
    color = normalizedColor(color);
    let m = color.match(/rgba?\((\d+), (\d+), (\d+)/);
    return {r:+m[1], g:+m[2], b:+m[3]};
}

// ðŸŽ¯ Return % similarity
function colorSimilarity(a, b) {
    let r = a.r - b.r;
    let g = a.g - b.g;
    let bDiff = a.b - b.b;
    let dist = Math.sqrt(r*r + g*g + bDiff*bDiff);
    let max = Math.sqrt(255*255*3);
    return Math.round((1 - dist/max) * 100);
}

// ðŸ§  When the user guesses a color
function makeGuess() {
    let input = document.getElementById("colorInput");
    let guess = input.value.trim().toLowerCase();
    if (!guess) return;

    // Try normalizing â€” if browser can parse it, it's valid
    let normalized;
    try {
        normalized = normalizedColor(guess);
    } catch {
        alert("Invalid color name or format!");
        return;
    }

    let guessRGB = rgbObj(normalized);
    let secretRGB = rgbObj(secret);
    let similarity = colorSimilarity(guessRGB, secretRGB);

    // Add the guess to the list visually
    addGuessToList(normalized, similarity);

    // Check correct
    if (similarity === 100) {
        document.getElementById("resultMsg").innerHTML =
            `ðŸŽ‰ Correct! The secret color was <b>${secret}</b>. Refresh to play again!`;
    }

    input.value = "";
}

// ðŸ“Œ Add guess to the guess history list
function addGuessToList(color, similarity) {
    let list = document.getElementById("guessList");

    let item = document.createElement("div");
    item.className = "guessItem";

    let swatch = document.createElement("div");
    swatch.className = "swatch";
    swatch.style.background = color;

    if (similarity === 100) swatch.classList.add("correct");

    let text = document.createElement("div");
    text.textContent = `${color} â€” ${similarity}%`;

    item.appendChild(text);
    item.appendChild(swatch);

    list.prepend(item); // newest guess on top
}

</script>

</body>
</html>
