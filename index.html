<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Grow a Garden</title>
  <style>
    body {
      font-family: sans-serif;
      background: #e2f4d7;
      margin: 0;
      padding: 0;
      text-align: center;
    }
    h1 {
      margin: 10px;
    }
    #ui {
      margin-bottom: 20px;
    }
    .grid {
      display: grid;
      grid-template-columns: repeat(5, 60px);
      gap: 5px;
      justify-content: center;
    }
    .plot {
      width: 60px;
      height: 60px;
      background: #9f765d;
      border: 2px solid #654321;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 24px;
      cursor: pointer;
    }
    .planted {
      background: #4caf50;
    }
    .marketItem {
      display: inline-block;
      padding: 10px;
      margin: 5px;
      background: #fff;
      border: 2px solid #ccc;
      cursor: pointer;
    }
    .marketIcon {
      font-size: 20px;
    }
    .store, .pets {
      margin: 10px;
    }
    .timer {
      margin-top: 10px;
    }
  </style>
</head>
<body>
  <h1>üå± Grow a Garden</h1>
  <div id="ui">
    <div id="resources">üí∞ Gold: 0 | üåæ Seeds: 0 | üí© Fertilizer: 0</div>
    <div id="timers" class="timer">
      <div id="marketTimer">Next restock in: 05:00</div>
      <div id="eventTimer">Next random event in: 00:60</div>
    </div>
  </div>
  <div class="grid" id="farm"></div>

  <div class="store">
    <h2>üõí Store</h2>
    <button id="buySeed">Buy Seed (10g)</button>
    <button id="buyFertilizer">Buy Fertilizer (10g)</button>
    <button id="upgradeSeed">Upgrade Seed Cost (-10%) (50g)</button>
    <button id="upgradeSell">Upgrade Sell Price (+10%) (50g)</button>
  </div>

  <div class="store">
    <h2>üåæ Market</h2>
    <div id="marketGrid"></div>
  </div>

  <div class="pets">
    <h2>üêû Pets</h2>
    <button id="buyButterfly">Butterfly (Auto Water, 100g)</button>
    <button id="buyLadybug">Ladybug (Pest Immunity, 100g)</button>
    <button id="buyBird">Bird (Faster Growth, 150g)</button>
  </div>

  <script>
    (() => {
      const NUM_PLOTS = 10;
      const DAY_DURATION = 60000;
      const MARKET_RESTOCK_INTERVAL = 300000;

      let gold = 100;
      let seeds = 2;
      let fertilizer = 1;
      let seedCostMultiplier = 1;
      let sellPriceMultiplier = 1;

      const crops = [
        { name: 'Carrot', icon: 'ü•ï', growTime: 15000, baseSellPrice: 15 },
        { name: 'Corn', icon: 'üåΩ', growTime: 20000, baseSellPrice: 20 },
        { name: 'Tomato', icon: 'üçÖ', growTime: 18000, baseSellPrice: 18 },
        { name: 'Pumpkin', icon: 'üéÉ', growTime: 25000, baseSellPrice: 30 },
        { name: 'Mystery Fruit', icon: 'üçá', growTime: 30000, baseSellPrice: 50 }
      ];

      let plots = [];
      let marketStock = [];
      let marketTimer = MARKET_RESTOCK_INTERVAL;
      let pets = {
        butterfly: { owned: false, cost: 100 },
        ladybug: { owned: false, cost: 100 },
        bird: { owned: false, cost: 150 }
      };

      const farm = document.getElementById('farm');
      const resources = document.getElementById('resources');
      const marketGrid = document.getElementById('marketGrid');
      const marketTimerEl = document.getElementById('marketTimer');
      const eventTimerEl = document.getElementById('eventTimer');
      const buySeedBtn = document.getElementById('buySeed');
      const buyFertilizerBtn = document.getElementById('buyFertilizer');
      const upgradeSeedCostBtn = document.getElementById('upgradeSeed');
      const upgradeSellPriceBtn = document.getElementById('upgradeSell');
      const petButterflyBtn = document.getElementById('buyButterfly');
      const petLadybugBtn = document.getElementById('buyLadybug');
      const petBirdBtn = document.getElementById('buyBird');

      function getSeedCost() {
        return Math.floor(10 * seedCostMultiplier);
      }

      function getSellPrice(base, fertilized) {
        let price = base;
        if (fertilized) price += 5;
        return Math.floor(price * sellPriceMultiplier);
      }

      function updateUI() {
        resources.textContent = `üí∞ Gold: ${gold} | üåæ Seeds: ${seeds} | üí© Fertilizer: ${fertilizer}`;
        renderMarket();
      }

      function createFarmGrid() {
        for (let i = 0; i < NUM_PLOTS; i++) {
          const div = document.createElement('div');
          div.className = 'plot';
          div.addEventListener('click', () => onPlotClick(i));
          farm.appendChild(div);
          plots.push({
            planted: false,
            cropIndex: null,
            growth: 0,
            watered: false,
            fertilizer: false,
            pest: false,
            element: div,
            intervalId: null
          });
        }
      }

      function plantSeed(index) {
        const cropIndex = Math.floor(Math.random() * crops.length);
        const plot = plots[index];
        plot.planted = true;
        plot.cropIndex = cropIndex;
        plot.growth = 0;
        plot.watered = pets.butterfly.owned ? true : false;
        plot.fertilizer = false;
        plot.pest = !pets.ladybug.owned && Math.random() < 0.2;
        plot.element.classList.add('planted');
        plot.element.textContent = crops[cropIndex].icon;
        seeds--;
        const growthBoost = pets.bird.owned ? 0.75 : 1;

        plot.intervalId = setInterval(() => {
          if (plot.watered) plot.growth += 1000 * (1 / growthBoost);
          if (plot.growth >= crops[cropIndex].growTime) {
            plot.growth = crops[cropIndex].growTime;
            clearInterval(plot.intervalId);
            plot.intervalId = null;
          }
        }, 1000);
        updateUI();
      }

      function onPlotClick(index) {
        const plot = plots[index];
        if (!plot.planted && seeds > 0) return plantSeed(index);

        if (plot.planted && plot.growth >= crops[plot.cropIndex].growTime) {
          gold += getSellPrice(crops[plot.cropIndex].baseSellPrice, plot.fertilizer);
          plot.planted = false;
          plot.cropIndex = null;
          plot.growth = 0;
          plot.watered = false;
          plot.fertilizer = false;
          plot.pest = false;
          plot.element.classList.remove('planted');
          plot.element.textContent = '';
          updateUI();
        } else if (plot.planted && !plot.watered) {
          plot.watered = true;
        } else if (plot.planted && !plot.fertilizer && fertilizer > 0) {
          plot.fertilizer = true;
          fertilizer--;
          updateUI();
        }
      }

      buySeedBtn.onclick = () => {
        const cost = getSeedCost();
        if (gold >= cost) {
          gold -= cost;
          seeds++;
          updateUI();
        }
      };

      buyFertilizerBtn.onclick = () => {
        if (gold >= 10) {
          gold -= 10;
          fertilizer++;
          updateUI();
        }
      };

      upgradeSeedCostBtn.onclick = () => {
        if (gold >= 50) {
          gold -= 50;
          seedCostMultiplier *= 0.9;
          updateUI();
        }
      };

      upgradeSellPriceBtn.onclick = () => {
        if (gold >= 50) {
          gold -= 50;
          sellPriceMultiplier *= 1.1;
          updateUI();
        }
      };

      petButterflyBtn.onclick = () => {
        if (!pets.butterfly.owned && gold >= pets.butterfly.cost) {
          gold -= pets.butterfly.cost;
          pets.butterfly.owned = true;
          updateUI();
        }
      };

      petLadybugBtn.onclick = () => {
        if (!pets.ladybug.owned && gold >= pets.ladybug.cost) {
          gold -= pets.ladybug.cost;
          pets.ladybug.owned = true;
          updateUI();
        }
      };

      petBirdBtn.onclick = () => {
        if (!pets.bird.owned && gold >= pets.bird.cost) {
          gold -= pets.bird.cost;
          pets.bird.owned = true;
          updateUI();
        }
      };

      function restockMarket() {
        marketStock = [];
        const pool = [...crops];
        for (let i = 0; i < 3; i++) {
          const idx = Math.floor(Math.random() * pool.length);
          const item = pool.splice(idx, 1)[0];
          marketStock.push({ ...item, price: Math.floor(item.baseSellPrice / 2) });
        }
      }

      function renderMarket() {
        marketGrid.innerHTML = '';
        marketStock.forEach(item => {
          const div = document.createElement('div');
          div.className = 'marketItem';
          div.innerHTML = `<div class="marketIcon">${item.icon}</div><div>${item.name}</div><div>${item.price}g</div>`;
          div.onclick = () => {
            if (gold >= item.price) {
              gold -= item.price;
              seeds++;
              updateUI();
            }
          };
          marketGrid.appendChild(div);
        });
      }

      // Timers
      setInterval(() => {
        marketTimer -= 1000;
        if (marketTimer <= 0) {
          restockMarket();
          marketTimer = MARKET_RESTOCK_INTERVAL;
        }
        const m = String(Math.floor(marketTimer / 60000)).padStart(2, '0');
        const s = String(Math.floor((marketTimer % 60000) / 1000)).padStart(2, '0');
        marketTimerEl.textContent = `Next restock in: ${m}:${s}`;
      }, 1000);

      let eventTime = DAY_DURATION;
      setInterval(() => {
        eventTime -= 1000;
        if (eventTime <= 0) eventTime = DAY_DURATION;
        eventTimerEl.textContent = `Next random event in: 00:${String(Math.floor(eventTime / 1000)).padStart(2, '0')}`;
      }, 1000);

      createFarmGrid();
      restockMarket();
      updateUI();
    })();
  </script>
</body>
</html>
