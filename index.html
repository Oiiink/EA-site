<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Grow a Garden - Farming Simulator</title>
<style>
  body {
    font-family: Arial, sans-serif;
    background: #8bc34a;
    margin: 0;
    padding: 20px;
    user-select: none;
    display: flex;
    flex-direction: column;
    align-items: center;
    transition: background 1s;
  }
  h1 {
    color: #3e621f;
  }
  #status {
    color: #2e4a11;
    margin-bottom: 15px;
    font-size: 18px;
  }
  #inventory {
    margin-bottom: 20px;
    color: #2e4a11;
    display: flex;
    gap: 12px;
    flex-wrap: wrap;
    justify-content: center;
  }
  #inventory > div {
    background: #558b2f;
    padding: 10px 16px;
    border-radius: 8px;
    color: white;
    font-weight: bold;
    user-select: none;
  }
  button {
    padding: 8px 14px;
    background: #33691e;
    color: white;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    font-weight: bold;
    transition: background 0.3s;
  }
  button:disabled {
    background: #9ccc65;
    cursor: default;
  }
  #farmGrid {
    display: grid;
    grid-template-columns: repeat(5, 80px);
    grid-template-rows: repeat(3, 80px);
    gap: 12px;
  }
  .plot {
    width: 80px;
    height: 80px;
    background: #6d4c41;
    border-radius: 10px;
    box-shadow: inset 0 0 5px #3e2723;
    position: relative;
    cursor: pointer;
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
  }
  .plot.planted {
    background: #3e7d16;
  }
  .progressBar {
    position: absolute;
    bottom: 6px;
    left: 6px;
    right: 6px;
    height: 12px;
    background: rgba(255, 255, 255, 0.3);
    border-radius: 6px;
    overflow: hidden;
  }
  .progressFill {
    height: 100%;
    background: #fbc02d;
    width: 0%;
    border-radius: 6px;
    transition: width 0.2s linear;
  }
  .cropIcon {
    font-size: 30px;
    pointer-events: none;
    user-select: none;
  }
  #upgrades {
    margin-top: 20px;
    max-width: 420px;
    display: flex;
    flex-wrap: wrap;
    justify-content: center;
    gap: 10px;
  }
  .upgradeBtn {
    flex: 1 1 45%;
    background: #33691e;
  }
  #dayNightCycle {
    margin-top: 20px;
    font-weight: bold;
    color: #2e4a11;
  }
</style>
</head>
<body>

<h1>Grow a Garden üå±</h1>

<div id="status">
  Gold: <span id="gold">20</span> &nbsp;&nbsp; Seeds: <span id="seedCount">5</span> &nbsp;&nbsp; Fertilizer: <span id="fertilizerCount">0</span>
</div>

<div id="inventory">
  <button id="buySeedBtn">Buy Seed (5 Gold)</button>
  <button id="buyFertilizerBtn">Buy Fertilizer (10 Gold)</button>
</div>

<div id="farmGrid"></div>

<div id="upgrades">
  <button class="upgradeBtn" id="upgradeSeedCostBtn">Upgrade Seed Cost (-10%) - 50 Gold</button>
  <button class="upgradeBtn" id="upgradeSellPriceBtn">Upgrade Sell Price (+10%) - 50 Gold</button>
</div>

<div id="dayNightCycle">Day Time</div>

<script>
(() => {
  const ROWS = 3;
  const COLS = 5;

  // Game state variables
  let gold = 20;
  let seeds = 5;
  let fertilizer = 0;

  // Upgrades state
  let seedCostMultiplier = 1.0; // reduces seed cost
  let sellPriceMultiplier = 1.0; // increases sell price

  // Day/Night cycle
  let isDay = true;
  const DAY_DURATION = 30000; // 30 seconds day, 30 seconds night

  // DOM Elements
  const goldEl = document.getElementById('gold');
  const seedCountEl = document.getElementById('seedCount');
  const fertilizerCountEl = document.getElementById('fertilizerCount');
  const buySeedBtn = document.getElementById('buySeedBtn');
  const buyFertilizerBtn = document.getElementById('buyFertilizerBtn');
  const farmGrid = document.getElementById('farmGrid');
  const upgradeSeedCostBtn = document.getElementById('upgradeSeedCostBtn');
  const upgradeSellPriceBtn = document.getElementById('upgradeSellPriceBtn');
  const dayNightCycleEl = document.getElementById('dayNightCycle');

  // Crop types
  // Each crop: name, growTime (ms), sellPrice, icon
  const crops = [
    {name: 'Carrot', growTime: 6000, baseSellPrice: 10, icon: 'ü•ï'},
    {name: 'Tomato', growTime: 9000, baseSellPrice: 15, icon: 'üçÖ'},
    {name: 'Pumpkin', growTime: 15000, baseSellPrice: 30, icon: 'üéÉ'},
  ];

  // Plot state: {planted: bool, growth: ms, cropIndex: int, watered: bool, fertilizer: bool, intervalId: int|null, element: HTMLElement}
  const plots = [];

  // Initialize farm grid UI
  function createFarmGrid() {
    farmGrid.innerHTML = '';
    for(let i=0; i<ROWS*COLS; i++) {
      const plot = document.createElement('div');
      plot.classList.add('plot');
      plot.dataset.index = i;
      farmGrid.appendChild(plot);

      plots[i] = {
        planted: false,
        growth: 0,
        cropIndex: null,
        watered: false,
        fertilizer: false,
        intervalId: null,
        element: plot,
      };

      plot.addEventListener('click', () => onPlotClick(i));
    }
  }

  // Update UI displays
  function updateUI() {
    goldEl.textContent = gold;
    seedCountEl.textContent = seeds;
    fertilizerCountEl.textContent = fertilizer;

    buySeedBtn.disabled = gold < getSeedCost();
    buyFertilizerBtn.disabled = gold < 10;

    upgradeSeedCostBtn.disabled = gold < 50;
    upgradeSellPriceBtn.disabled = gold < 50;
  }

  // Calculate current seed cost based on upgrades
  function getSeedCost() {
    return Math.max(1, Math.floor(5 * seedCostMultiplier));
  }

  // Calculate sell price of crop with fertilizer and upgrades
  function getSellPrice(basePrice, hasFertilizer) {
    let price = basePrice * sellPriceMultiplier;
    if (hasFertilizer) price *= 1.5;
    return Math.floor(price);
  }

  // Plant seed function: choose crop randomly for fun
  function plantSeed(index) {
    if (plots[index].planted || seeds <= 0) return false;

    // Random crop chosen to plant
    const cropIndex = Math.floor(Math.random() * crops.length);
    const crop = crops[cropIndex];

    seeds--;
    updateUI();

    const plot = plots[index];
    plot.planted = true;
    plot.growth = 0;
    plot.cropIndex = cropIndex;
    plot.watered = false;
    plot.fertilizer = false;

    plot.element.classList.add('planted');
    plot.element.innerHTML = '';

    // Crop icon
    const cropIcon = document.createElement('div');
    cropIcon.className = 'cropIcon';
    cropIcon.textContent = crops[cropIndex].icon;
    plot.element.appendChild(cropIcon);

    // Progress bar
    const progressBar = document.createElement('div');
    progressBar.className = 'progressBar';
    const progressFill = document.createElement('div');
    progressFill.className = 'progressFill';
    progressBar.appendChild(progressFill);
    plot.element.appendChild(progressBar);

    // Water icon if watered
    const waterIcon = document.createElement('div');
    waterIcon.style.position = 'absolute';
    waterIcon.style.top = '6px';
    waterIcon.style.right = '6px';
    waterIcon.style.fontSize = '20px';
    waterIcon.style.opacity = '0.6';
    waterIcon.textContent = '';
    plot.element.appendChild(waterIcon);

    // Fertilizer icon if fertilized
    const fertIcon = document.createElement('div');
    fertIcon.style.position = 'absolute';
    fertIcon.style.bottom = '6px';
    fertIcon.style.right = '6px';
    fertIcon.style.fontSize = '20px';
    fertIcon.style.opacity = '0.8';
    fertIcon.textContent = '';
    plot.element.appendChild(fertIcon);

    // Growth interval
    plot.intervalId = setInterval(() => {
      if (!plot.planted) {
        clearInterval(plot.intervalId);
        plot.intervalId = null;
        return;
      }

      // Growth rate modifier
      let growthRate = 200; // ms per growth unit
      if (plot.watered) growthRate /= 2;
      if (plot.fertilizer) growthRate /= 1.5;

      plot.growth += 1000 / growthRate;

      // Update progress bar
      let progressPercent = Math.min(100, (plot.growth / crops[cropIndex].growTime) * 100);
      progressFill.style.width = progressPercent + '%';

      // Update icons
      waterIcon.textContent = plot.watered ? 'üíß' : '';
      fertIcon.textContent = plot.fertilizer ? 'üåø' : '';

      if (plot.growth >= crops[cropIndex].growTime) {
        plot.growth = crops[cropIndex].growTime;
        clearInterval(plot.intervalId);
        plot.intervalId = null;
        // Change crop icon to grown
        cropIcon.textContent = 'üåæ';
      }
    }, 300);
    return true;
  }

  // Harvest crop function
  function harvestCrop(index) {
    const plot = plots[index];
    if (!plot.planted) return false;
    if (plot.growth < crops[plot.cropIndex].growTime) return false;

    // Calculate sell price
    const crop = crops[plot.cropIndex];
    const sellPrice = getSellPrice(crop.baseSellPrice, plot.fertilizer);

    gold += sellPrice;
    updateUI();

    // Reset plot
    plot.planted = false;
    plot.growth = 0;
    plot.cropIndex = null;
    plot.watered = false;
    plot.fertilizer = false;

    plot.element.classList.remove('planted');
    plot.element.innerHTML = '';

    return true;
  }

  // Water plot function
  function waterPlot(index) {
    const plot = plots[index];
    if (!plot.planted) return false;
    plot.watered = true;
    return true;
  }

  // Apply fertilizer to plot
  function applyFertilizer(index) {
    const plot = plots[index];
    if (!plot.planted) return false;
    if (fertilizer <= 0) return false;
    if (plot.fertilizer) return false; // only one fertilizer per plot

    fertilizer--;
    plot.fertilizer = true;
    updateUI();
    return true;
  }

  // Handle clicking on plots:
  // If empty: plant seed if possible
  // If planted & grown: harvest
  // If planted & not grown: water or apply fertilizer (choose with prompt)
  function onPlotClick(index) {
    const plot = plots[index];

    if (!plot.planted) {
      if (seeds <= 0) {
        alert('No seeds available. Buy more seeds!');
        return;
      }
      if (!plantSeed(index)) {
        alert('Cannot plant seed here.');
      }
      return;
    }

    if (plot.growth >= crops[plot.cropIndex].growTime) {
      harvestCrop(index);
      return;
    }

    // Not fully grown, ask watering or fertilizer
    if (fertilizer > 0 && !plot.fertilizer) {
      const choice = confirm('Apply fertilizer to speed growth? (Cancel to water instead)');
      if (choice) {
        if (!applyFertilizer(index)) alert('Cannot apply fertilizer here.');
        return;
      }
    }
    waterPlot(index);
  }

  // Buy seed
  buySeedBtn.addEventListener('click', () => {
    const cost = getSeedCost();
    if (gold >= cost) {
      gold -= cost;
      seeds++;
      updateUI();
    }
  });

  // Buy fertilizer
  buyFertilizerBtn.addEventListener('click', () => {
    if (gold >= 10) {
      gold -= 10;
      fertilizer++;
      updateUI();
    }
  });

  // Upgrades
  upgradeSeedCostBtn.addEventListener('click', () => {
    if (gold >= 50) {
      gold -= 50;
      seedCostMultiplier = Math.max(0.5, seedCostMultiplier - 0.1);
      alert('Seed cost reduced by 10%!');
      updateUI();
    }
  });
  upgradeSellPriceBtn.addEventListener('click', () => {
    if (gold >= 50) {
      gold -= 50;
      sellPriceMultiplier += 0.1;
      alert('Sell price increased by 10%!');
      updateUI();
    }
  });

  // Day/Night cycle toggle
  function toggleDayNight() {
    isDay = !isDay;
    if (isDay) {
      document.body.style.background = '#8bc34a';
      dayNightCycleEl.textContent = 'Day Time';
    } else {
      document.body.style.background = '#264d00';
      dayNightCycleEl.textContent = 'Night Time (Water plants!)';
      // Water all plants automatically at night start
      plots.forEach(plot => {
        if (plot.planted) plot.watered = false;
      });
    }
  }
  setInterval(toggleDayNight, DAY_DURATION);

  // Init
  createFarmGrid();
  updateUI();
})();
</script>

</body>
</html>
